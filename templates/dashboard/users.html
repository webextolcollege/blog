{% extends 'base.html' %}

{% block content %}

<main class="container my-4" role="main">
  <div class="row">

    <!-- Sidebar Navigation -->
    <aside class="col-md-3" aria-label="Dashboard Navigation">
      {% include 'dashboard/sidebar.html' %}
    </aside>

    <!-- Main Content -->
    <section class="col-md-9" aria-labelledby="page-title">

      {% if perms.auth.view_user %}

      <header class="d-flex justify-content-between align-items-center mb-3">
        <h1 id="page-title" class="h3 text-dark mb-0">
          All Users
        </h1>

        <a
          href="{% url 'add_user' %}"
          class="btn btn-dark text-light"
          aria-label="Add New User"
        >
          Add New User
        </a>
      </header>

      <div class="table-responsive">
        <table class="table table-hover" aria-describedby="users-table-description">
          <caption id="users-table-description" class="visually-hidden">
            List of registered users with account status and actions
          </caption>

          <thead class="table-light">
            <tr>
              <th scope="col">#</th>
              <th scope="col">Full Name</th>
              <th scope="col">Username</th>
              <th scope="col">Email</th>
              <th scope="col">Active</th>
              <th scope="col">Staff</th>
              <th scope="col">Superuser</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>

          <tbody>
            {% for user in users %}
            <tr>
              <th scope="row">{{ forloop.counter }}</th>

              <td>{{ user.first_name }} {{ user.last_name }}</td>
              <td>{{ user.username }}</td>
              <td>{{ user.email }}</td>

              <td>
                {% if user.is_active %}
                  <span class="text-success" aria-label="Active user">✔</span>
                {% else %}
                  <span class="text-danger" aria-label="Inactive user">✘</span>
                {% endif %}
              </td>

              <td>
                {% if user.is_staff %}
                  <span class="text-success" aria-label="Staff member">✔</span>
                {% else %}
                  <span class="text-danger" aria-label="Not staff">✘</span>
                {% endif %}
              </td>

              <td>
                {% if user.is_superuser %}
                  <span class="text-success" aria-label="Superuser">✔</span>
                {% else %}
                  <span class="text-danger" aria-label="Not superuser">✘</span>
                {% endif %}
              </td>

              <td>
                <a
                  href="{% url 'edit_user' user.id %}"
                  class="text-success me-2"
                  aria-label="Edit user {{ user.username }}"
                >
                  <i class="fa fa-edit"></i>
                </a>

                <a
                  href="{% url 'delete_user' user.id %}"
                  class="text-danger"
                  aria-label="Delete user {{ user.username }}"
                >
                  <i class="fa fa-trash"></i>
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% else %}

      <p class="text-center text-danger fw-bold" role="alert">
        You do not have permission to view this page.
      </p>

      {% endif %}

    </section>
  </div>
</main>

{% endblock %}
